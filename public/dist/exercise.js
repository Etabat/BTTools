function displayChallenge(){function e(e){var t=$(e.target);if(t.is("p"))for(var n=document.querySelectorAll(".hot-thought"),a=0;a<n.length;a++)n[a].textContent="Selected hot-thought: "+e.target.innerText,displayEmotions(e)}$(".thoughts-list").click(e)}function displayEmotions(e){$("#reassess").on("show.bs.modal",function(){var t=document.querySelector("#reassess form");refreshEmotions(t);for(var n=e.target.parentNode.previousSibling.childNodes,a=0;a<n.length;a++)if("P"==n[a].nodeName){var r=n[a].dataset.emotion,l=document.createElement("div");l.className="form-group"+r,t.appendChild(l);var o=document.createElement("label");setAttributes(o,{"for":"percent-"+r,"class":"range"}),o.textContent=r,l.appendChild(o),displayRange(l,n,r,a)}})}function refreshEmotions(e){for(;e.lastChild;)e.removeChild(e.lastChild)}function setAttributes(e,t){for(var n in t)e.setAttribute(n,t[n])}function displayRange(e,t,n,a){var r=document.createElement("input");setAttributes(r,{id:"percent-"+n,type:"range",name:"range",min:"0",max:"100",value:"50",step:"5"}),e.appendChild(r);var l=document.createElement("output");setAttributes(l,{id:"resultOf"+n}),e.appendChild(l);var o=t[a].dataset.range;!function(e){var t=document.getElementById("percent-"+e),n=document.getElementById("resultOf"+e);t.value=o,n.innerText=t.value+"%",t.addEventListener("input",function(){n.innerText=t.value+"%"},!1)}(n)}function validateChallenge(e){var t=new XMLHttpRequest;t.open("POST","/secureFormData/answers/5000/challenges",!0),t.setRequestHeader("Content-type","application/json"),t.send(catalogChallenge(e)),t.addEventListener("error",function(){alert("Something went wrong.")})}function catalogChallenge(e){var t={};t.submissionDate=Date.now(),t.hotThought=e.target.parentElement.parentElement.children[0].lastElementChild.textContent,t.evidence=document.getElementById("evidence").value,t.evidenceAgainst=document.getElementById("evidence-against").value,t.alternative=document.getElementById("alternative").value;var n=document.querySelector("#reassess form").childNodes;t.emotionsAndRange={};for(var a=0;a<n.length;a++){var r=n[a].childNodes[0].innerText,l=n[a].childNodes[2].value;t.emotionsAndRange[r]=l}return JSON.stringify(t)}function clearForm(){document.getElementById("evidence").value="",document.getElementById("evidence-against").value="",document.getElementById("alternative").value=""}var xhr=new XMLHttpRequest;xhr.open("GET","./secureFormData/answers/5000/stress-logs",!0),xhr.send(),xhr.addEventListener("load",function(e){4!==xhr.readyState||200!==xhr.status&&304!=xhr.status?alert(e.target.responseText):displayChallenge()});var submit=document.getElementById("validate");submit.addEventListener("click",function(e){e.preventDefault(),validateChallenge(e),clearForm(e)});var clear=document.getElementById("cancel");clear.addEventListener("click",function(){clearForm()});